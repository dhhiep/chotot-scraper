$ ->
  $('#accounts-table').dataTable
    responsive: true
    processing: true
    autoWidth: false
    oLanguage:
      sProcessing: '<%= image_tag("Spinner.gif") %>'
    serverSide: true
    searchDelay: 800
    pageLength: 25
    ajax: $('#accounts-table').data('source')
    pagingType: 'full_numbers'
    columns: [
      {data: 'id'}
      {data: 'full_name'}
      {data: 'phone'}
      {data: 'address'}
      {data: 'status'}
      {data: 'area_name'}
      # {data: 'category'}
      {data: 'action_edit', searchable: false, sortable: false}
    ]

  window.fetchSummary = ->
    $.ajax
      type: 'GET'
      url: '/accounts/fetch_summary'
      dataType: 'script'

  markAccountWasReviewed = (id) ->
    $.ajax
      type: 'POST'
      url: '/accounts/' + id + '/mark_review'
      dataType: 'script'

  clipboard = new ClipboardJS('.copy-account-phone');
  clipboard.on 'success', (e) ->
    element = $(e.trigger)
    # Update text
    element.html('Copied')
    id = element.data('id')
    markAccountWasReviewed(id)
    setTimeout ->
      element.html("<i class='fa fa-copy'></i>")
    , 1000
